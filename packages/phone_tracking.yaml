template:
  - binary_sensor:
      - name: Corban Home
        device_class: presence
        default_entity_id: binary_sensor.corban_person_home
        availability: "{{ has_value('person.corban') }}"
        state: "{{ is_state('person.corban', 'home') }}"
      - name: Maggie Home
        device_class: presence
        default_entity_id: binary_sensor.maggie_person_home
        availability: "{{ has_value('person.maggie') }}"
        state: "{{ is_state('person.maggie', 'home') }}"

  - sensor:
      - name: Maggie's ETA
        unit_of_measurement: minutes
        default_entity_id: sensor.maggie_time_to_home_for_display
        availability: >-
          {{
            has_value('person.maggie') and
            has_value('sensor.maggie_to_home_travel_time')
          }}
        state: >-
          {% if is_state('person.maggie', 'home') %}
            0
          {% else %}
            {{ states('sensor.maggie_to_home_travel_time') | round }}
          {% endif %}

      - name: Corban's Location
        default_entity_id: sensor.corban_location_icon
        icon: >-
          {% set state = states('person.corban') %}

          {% if state == "home" %}
            mdi:home
          {% elif state == "Gym" %}
            mdi:kettlebell
          {% elif state == "Mimi and Pop's House" %}
            mdi:shovel
          {% else %}
            mdi:account-outline
          {% endif %}
        state: "{{ states('person.corban') }}"

      - name: Maggie's Location
        default_entity_id: sensor.maggie_location_icon
        icon: >-
          {% set state = states('person.maggie') %}

          {% if state == "home" %}
            mdi:home
          {% elif state == "L3Harris" %}
            mdi:telescope
          {% elif state == "Clay Studio" %}
            mdi:glass-mug
          {% elif state == "Mimi and Pop's House" %}
            mdi:shovel
          {% elif state == "Gym" %}
            mdi:kettlebell
          {% else %}
            mdi:account-outline
          {% endif %}
        state: "{{ states('person.maggie') }}"

      - name: Cat's Location
        default_entity_id: sensor.cat_location_icon
        icon: >-
          {% if is_state('input_boolean.cats_are_home', 'on') %}
            mdi:home-heart
          {% else %}
            mdi:heart-broken
          {% endif %}
        state: "{{ states('input_boolean.cats_are_home') }}"
