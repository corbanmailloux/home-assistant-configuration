- id: '1703638107345'
  alias: Office Closet Light - Door Trigger
  description: ''
  use_blueprint:
    path: mkosmo/closet-light-from-door-sensor.yaml
    input:
      door_sensor: binary_sensor.office_closet_door_sensor_contact
      light_switch:
        entity_id: light.office_closet_light
      light_timeout: 1800
- id: '1705870296732'
  alias: Hall Aux Switch - Pause Living Room TV
  description: ''
  trigger:
  - platform: device
    domain: mqtt
    device_id: f6a3f0606ae31f561f4c700f5917deed
    type: action
    subtype: aux_config_single
    discovery_id: 0xb43a31fffe34e475 action_aux_config_single
  condition: []
  action:
  - service: media_player.media_play_pause
    metadata: {}
    data: {}
    target:
      device_id: 0e47eccd7765e50037be8ffc24099a13
  mode: single
- id: '1710728057701'
  alias: Linen Closet Light - Door Trigger
  description: ''
  use_blueprint:
    path: mkosmo/closet-light-from-door-sensor.yaml
    input:
      door_sensor: binary_sensor.linen_closet_door_sensor_contact
      light_switch:
        entity_id:
        - light.linen_closet_wall_switch
      light_timeout: 1800
- id: '1710728130096'
  alias: Coat Closet Light - Door Trigger
  description: ''
  use_blueprint:
    path: mkosmo/closet-light-from-door-sensor.yaml
    input:
      door_sensor: binary_sensor.coat_closet_door_sensor_contact
      light_switch:
        entity_id: light.coat_closet_light
      light_timeout: 1800
- id: '1710814441742'
  alias: Hold Kitchen Light Switches to Control Area Lights
  description: ''
  trigger:
  - platform: device
    domain: mqtt
    device_id: 9f61f3f1b573c3799a54ee705f98034f
    type: action
    subtype: up_held
    id: 'on'
  - platform: device
    domain: mqtt
    device_id: 9f61f3f1b573c3799a54ee705f98034f
    type: action
    subtype: down_held
    id: 'off'
  - platform: device
    domain: mqtt
    device_id: f6a3f0606ae31f561f4c700f5917deed
    type: action
    subtype: up_held
    id: 'on'
  - platform: device
    domain: mqtt
    device_id: f6a3f0606ae31f561f4c700f5917deed
    type: action
    subtype: down_held
    id: 'off'
  condition: []
  action:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - 'on'
      sequence:
      - service: light.turn_on
        metadata: {}
        data: {}
        target:
          area_id: 4872200594374640b069eaeee79e9ec6
    - conditions:
      - condition: trigger
        id:
        - 'off'
      sequence:
      - service: light.turn_off
        metadata: {}
        data: {}
        target:
          area_id: 4872200594374640b069eaeee79e9ec6
  mode: single
- id: '1710989410744'
  alias: Display Garage Door Status on Kitchen Bar Light LED Strip
  description: ''
  trigger:
  - platform: state
    entity_id:
    - cover.ratgdo_left_garage_door_door
    - cover.ratgdo_right_garage_door_door
    - binary_sensor.garage_side_person_door_contact
  condition: []
  action:
  - choose:
    - conditions:
      - condition: or
        conditions:
        - condition: state
          entity_id: cover.ratgdo_right_garage_door_door
          state: open
        - condition: state
          entity_id: cover.ratgdo_left_garage_door_door
          state: open
        - condition: state
          entity_id: binary_sensor.garage_side_person_door_contact
          state: 'on'
      sequence:
      - service: script.inovelli_led_control
        metadata: {}
        data:
          led: All
          color: Purple
          level: 62
          duration: Indefinitely
          target:
            device_id: 9f61f3f1b573c3799a54ee705f98034f
          effect: Solid
        alias: Set LED strip to purple - Kitchen Bar Light
      - alias: Set LED strip to purple - Utility Closet Light
        service: script.inovelli_led_control
        metadata: {}
        data:
          led: All
          color: Purple
          level: 62
          duration: Indefinitely
          effect: Solid
          target:
            device_id: b61d7bab7432d5e91ddb6fb6e28bf5fd
      alias: If any door is open
    default:
    - service: script.inovelli_led_control
      metadata: {}
      data:
        led: All
        target:
          device_id: 9f61f3f1b573c3799a54ee705f98034f
        effect: Clear
      alias: Clear LED Strip - Kitchen Bar Light
    - alias: Clear LED Strip - Utility Closet Light
      service: script.inovelli_led_control
      metadata: {}
      data:
        led: All
        target:
          device_id:
          - b61d7bab7432d5e91ddb6fb6e28bf5fd
        effect: Clear
  mode: single
- id: '1711145973507'
  alias: Pantry Door Light
  description: ''
  use_blueprint:
    path: mkosmo/closet-light-from-door-sensor.yaml
    input:
      door_sensor: binary_sensor.pantry_door_sensor_contact
      light_switch:
        entity_id: light.pantry_lights
      light_timeout: 1200
- id: '1711159946532'
  alias: Hall Light Aux Switch - Hold to Control Multiple Lights
  description: ''
  trigger:
  - platform: device
    domain: mqtt
    device_id: f6a3f0606ae31f561f4c700f5917deed
    type: action
    subtype: aux_up_held
    id: 'on'
  - platform: device
    domain: mqtt
    device_id: f6a3f0606ae31f561f4c700f5917deed
    type: action
    subtype: aux_down_held
    id: 'off'
  condition: []
  action:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - 'on'
      sequence:
      - service: light.turn_on
        metadata: {}
        data:
          transition: 0
        target:
          entity_id:
          - light.first_floor_hall_light
          - light.kitchen_main_lights
          - light.kitchen_bar_light
    - conditions:
      - condition: trigger
        id:
        - 'off'
      sequence:
      - service: light.turn_off
        metadata: {}
        data:
          transition: 0
        target:
          entity_id:
          - light.first_floor_hall_light
          - light.kitchen_main_lights
          - light.kitchen_bar_light
  mode: single
- id: '1712374070637'
  alias: Mudroom Lamp Follows Kitchen Bar Light
  description: ''
  triggers:
  - type: turned_on
    device_id: 9f61f3f1b573c3799a54ee705f98034f
    entity_id: bf668f7758c2b3fe2ca6adb4bf41ea23
    domain: light
    id: 'on'
    trigger: device
  - type: turned_off
    device_id: 9f61f3f1b573c3799a54ee705f98034f
    entity_id: bf668f7758c2b3fe2ca6adb4bf41ea23
    domain: light
    id: 'off'
    trigger: device
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - 'on'
      sequence:
      - metadata: {}
        data:
          transition: 0
          brightness_pct: 100
        target:
          device_id: def287c341c870f1a188cf2c5e84a3a3
        action: light.turn_on
      - metadata: {}
        data:
          transition: 0
          brightness_pct: 100
          color_temp_kelvin: 3200
        action: light.turn_on
        target:
          device_id: 5fde3d24df137723731bafe28dd07084
    - conditions:
      - condition: trigger
        id:
        - 'off'
      sequence:
      - metadata: {}
        data:
          transition: 0
        target:
          device_id:
          - def287c341c870f1a188cf2c5e84a3a3
          - 5fde3d24df137723731bafe28dd07084
        action: light.turn_off
  mode: single
- id: '1712671842634'
  alias: Guest Room Remote
  description: ''
  triggers:
  - device_id: f55558e66b8f403aed6dc6acc7450363
    domain: lutron_caseta
    type: press
    subtype: 'on'
    id: 'on'
    trigger: device
  - device_id: f55558e66b8f403aed6dc6acc7450363
    domain: lutron_caseta
    type: press
    subtype: 'off'
    id: 'off'
    trigger: device
  - device_id: f55558e66b8f403aed6dc6acc7450363
    domain: lutron_caseta
    type: press
    subtype: stop
    id: center
    trigger: device
  - device_id: f55558e66b8f403aed6dc6acc7450363
    domain: lutron_caseta
    type: press
    subtype: raise
    id: up
    trigger: device
  - device_id: f55558e66b8f403aed6dc6acc7450363
    domain: lutron_caseta
    type: press
    subtype: lower
    id: down
    trigger: device
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - 'on'
      sequence:
      - if:
        - condition: state
          entity_id: light.guest_bedroom_ceiling_fan_light
          state: 'on'
        then:
        - metadata: {}
          data:
            brightness_pct: 100
          target:
            entity_id: light.guest_bedroom_ceiling_fan_light
          action: light.turn_on
        else:
        - metadata: {}
          data: {}
          target:
            entity_id: light.guest_bedroom_ceiling_fan_light
          action: light.turn_on
        alias: Main light on, or to full brightness
    - conditions:
      - condition: trigger
        id:
        - 'off'
      sequence:
      - action: light.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: light.guest_bedroom_ceiling_fan_light
    - conditions:
      - condition: trigger
        id:
        - center
      sequence:
      - action: light.toggle
        metadata: {}
        data: {}
        target:
          entity_id: light.fairy_lights
    - conditions:
      - condition: trigger
        id:
        - up
      sequence:
      - alias: Brightness up
        metadata: {}
        data:
          brightness_step_pct: 25
        target:
          entity_id: light.guest_bedroom_ceiling_fan_light
        action: light.turn_on
    - conditions:
      - condition: trigger
        id:
        - down
      sequence:
      - metadata: {}
        data:
          brightness_step_pct: -25
        target:
          entity_id: light.guest_bedroom_ceiling_fan_light
        alias: Brightness down
        action: light.turn_on
  mode: single
- id: '1714258867767'
  alias: Kitchen Bar Light Switch - Double Tap Config for Garage Doors
  description: ''
  trigger:
  - platform: device
    domain: mqtt
    device_id: 9f61f3f1b573c3799a54ee705f98034f
    type: action
    subtype: config_double
  condition: []
  action:
  - choose:
    - conditions:
      - condition: or
        conditions:
        - condition: device
          device_id: 2bbbe29de187f6e1b1522f5f2513b258
          domain: cover
          entity_id: 5401d8e4327d5e9b6d71d56d09b8ec35
          type: is_open
        - condition: device
          device_id: a918ed1d740d5527c120a872d5b36fdd
          domain: cover
          entity_id: fa3c1b2c28746f6e9edce10a8a74e955
          type: is_open
      sequence:
      - service: cover.close_cover
        metadata: {}
        data: {}
        target:
          entity_id:
          - cover.ratgdo_right_garage_door_door
          - cover.ratgdo_left_garage_door_door
      alias: 'If either garage door is open, close it. '
    default:
    - service: cover.open_cover
      metadata: {}
      data: {}
      target:
        entity_id: cover.ratgdo_left_garage_door_door
  mode: single
- id: '1715117158694'
  alias: Upstairs Hall Light Switch - Triple tap config to move Eve to dump spot
  description: ''
  trigger:
  - platform: device
    domain: mqtt
    device_id: 6239543fc9a684fbba5d4af77ccdf052
    type: action
    subtype: config_triple
  condition: []
  action:
  - service: script.vacuum_dump_process
    metadata: {}
    data: {}
  mode: single
- id: '1724423649065'
  alias: Stairs Wall Switch - Red During Meetings
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.corban_on_a_call
    from: 'off'
    to: 'on'
    id: 'on'
  - platform: state
    entity_id:
    - binary_sensor.corban_on_a_call
    from: 'on'
    to: 'off'
    id: 'off'
  condition: []
  action:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - 'on'
      sequence:
      - action: script.inovelli_led_control
        metadata: {}
        data:
          led: All
          color: Red
          level: 100
          duration: Indefinitely
          target:
            device_id: 6239543fc9a684fbba5d4af77ccdf052
          effect: Aurora
    - conditions:
      - condition: trigger
        id:
        - 'off'
      sequence:
      - action: script.inovelli_led_control
        metadata: {}
        data:
          led: All
          color: Red
          level: 100
          duration: Indefinitely
          target:
            device_id: 6239543fc9a684fbba5d4af77ccdf052
          effect: Clear
  mode: single
- id: '1724980786427'
  alias: Notify if windows are open with rain forecast overnight
  description: ''
  trigger:
  - platform: time
    at: '22:00:00'
  condition:
  - condition: state
    entity_id: input_select.home_mode
    state: Home
  - condition: numeric_state
    entity_id: sensor.open_window_count
    above: 0
  action:
  - action: weather.get_forecasts
    metadata: {}
    data:
      type: hourly
    target:
      entity_id: weather.openweathermap
    response_variable: forecasts
    alias: Get Hourly Forecast
  - variables:
      hours_to_check: 8
      precip_percent_min: 70
      entity_id: weather.openweathermap
      max_precipitation_chance: '{{ forecasts[entity_id].forecast[0:hours_to_check]
        | map(attribute=''precipitation_probability'') | max }}'
  - alias: Check if there's >70% chance of rain in the next 8 hours
    condition: template
    value_template: '{{ max_precipitation_chance > precip_percent_min }}'
  - action: notify.corban
    metadata: {}
    data:
      title: Rain Tonight. Close Windows?
      message: 'There is a {{ max_precipitation_chance }}% chance of rain tonight
        and these windows are open: {{ states(''sensor.open_windows'') }}'
  mode: single
- id: '1725645532252'
  alias: Notify Corban when Ben leaves with guest mode on
  description: ''
  trigger:
  - platform: state
    entity_id:
    - device_tracker.bens_iphone_se_unifi
    to: not_home
    from: home
    for:
      hours: 0
      minutes: 3
      seconds: 0
  condition:
  - condition: state
    entity_id: input_boolean.guest_mode
    state: 'on'
  - condition: state
    entity_id: binary_sensor.corban_person_home
    state: 'off'
  action:
  - action: notify.corban
    metadata: {}
    data:
      message: Ben left
      title: Ben Left
  mode: single
- id: '1725649471485'
  alias: Toggle Living Room Cabinet Lights with Wall Switch Button
  description: ''
  trigger:
  - platform: device
    domain: mqtt
    device_id: 21e10aa0c624e6abdcbbbbb97e0373c5
    type: action
    subtype: config_single
  - platform: device
    domain: mqtt
    device_id: d9db549c961eecf0f3fc66794fe297ad
    type: action
    subtype: config_single
  condition: []
  action:
  - action: light.toggle
    metadata: {}
    data:
      brightness_pct: 100
    target:
      entity_id: light.living_room_cabinet_lights
  mode: single
- id: '1725812307580'
  alias: Reload the Wall Display After Home Assistant Restarts
  description: ''
  trigger:
  - platform: homeassistant
    event: start
  condition: []
  action:
  - action: script.tablet_wall_display_reload
    metadata: {}
    data: {}
  mode: single
- id: '1735588370721'
  alias: Office Closet Light - Door Trigger
  description: ''
  use_blueprint:
    path: mkosmo/closet-light-from-door-sensor.yaml
    input:
      door_sensor: binary_sensor.office_closet_door_sensor_contact
      light_switch:
        entity_id: light.office_closet
      light_timeout: 900
- id: '1735601423932'
  alias: Movie Mode - Lighting and Pause
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - media_player.living_room_apple_tv
    to: playing
    for:
      hours: 0
      minutes: 0
      seconds: 2
    id: playing
  - trigger: state
    entity_id:
    - media_player.living_room_apple_tv
    to:
    - paused
    - standby
    - 'off'
    id: paused
    for:
      seconds: 5
  - trigger: state
    entity_id:
    - input_boolean.movie_mode_active
    to: 'on'
    from: 'off'
    id: movie_mode_start
  - trigger: state
    entity_id:
    - input_boolean.movie_mode_active
    to: 'off'
    from: 'on'
    id: movie_mode_end
  - trigger: state
    entity_id:
    - binary_sensor.living_room_couch_presence
    from: 'on'
    to: 'off'
    id: couch_empty
  conditions:
  - condition: state
    entity_id: input_boolean.room_exclude_livingroom
    state: 'off'
    alias: Living Room automations are enabled
  - condition: state
    entity_id: input_select.home_mode
    state: Home
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - movie_mode_start
      sequence:
      - action: scene.turn_on
        metadata: {}
        target:
          entity_id: scene.movie_mode
        data:
          transition: 2
    - conditions:
      - condition: trigger
        id:
        - movie_mode_end
      sequence:
      - alias: If Cabinet Lights are on, set to bright. Otherwise, skip.
        if:
        - condition: state
          entity_id: light.living_room_cabinet_lights
          state: 'on'
        then:
        - action: scene.turn_on
          metadata: {}
          target:
            entity_id: scene.movie_mode_end
          data:
            transition: 2
  - condition: state
    entity_id: input_boolean.movie_mode_active
    state: 'on'
  - choose:
    - conditions:
      - condition: trigger
        id:
        - playing
      sequence:
      - action: scene.turn_on
        metadata: {}
        target:
          entity_id: scene.movie_mode
        data:
          transition: 1
    - conditions:
      - condition: trigger
        id:
        - paused
      sequence:
      - action: scene.turn_on
        metadata: {}
        data:
          transition: 1
        target:
          entity_id: scene.movie_mode_pause
    - conditions:
      - condition: trigger
        id:
        - couch_empty
      sequence:
      - action: media_player.media_pause
        metadata: {}
        data: {}
        target:
          entity_id: media_player.living_room_apple_tv
  mode: single
- id: '1735606719113'
  alias: Dining Room Switch - Dining Scene
  description: ''
  triggers:
  - domain: mqtt
    device_id: 8eb976a9c0f474a3f6de93a5f04bcb72
    type: action
    subtype: config_double
    trigger: device
  conditions: []
  actions:
  - action: scene.turn_on
    metadata: {}
    target:
      entity_id: scene.dining
    data:
      transition: 3
  mode: single
- id: '1735871090165'
  alias: Movie Mode - Set Wall Switch LED Bar
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - input_boolean.movie_mode_active
    from: 'off'
    to: 'on'
    id: 'on'
  - trigger: state
    entity_id:
    - input_boolean.movie_mode_active
    from: 'on'
    to: 'off'
    id: 'off'
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - 'on'
      sequence:
      - action: script.inovelli_led_control
        metadata: {}
        data:
          led: All
          color: Orange
          level: 7
          effect: Solid
          duration: Indefinitely
          target:
            device_id: d9db549c961eecf0f3fc66794fe297ad
    - conditions:
      - condition: trigger
        id:
        - 'off'
      sequence:
      - action: script.inovelli_led_control
        metadata: {}
        data:
          led: All
          color: Orange
          level: 5
          duration: Indefinitely
          target:
            device_id: d9db549c961eecf0f3fc66794fe297ad
          effect: Clear
  mode: single
- id: '1735871229135'
  alias: Movie Mode - Toggle with Wall Switch buttons
  description: ''
  triggers:
  - domain: mqtt
    device_id: d9db549c961eecf0f3fc66794fe297ad
    type: action
    subtype: config_double
    trigger: device
  - domain: mqtt
    device_id: 21e10aa0c624e6abdcbbbbb97e0373c5
    type: action
    subtype: config_double
    trigger: device
  conditions: []
  actions:
  - action: input_boolean.toggle
    metadata: {}
    data: {}
    target:
      entity_id: input_boolean.movie_mode_active
  mode: single
- id: '1741665583779'
  alias: Master Bathroom - Motion and Lux Nightlight
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.motion_nightlight_occupancy
    to: 'on'
    id: 'on'
  - trigger: state
    entity_id:
    - binary_sensor.motion_nightlight_occupancy
    id: 'off'
    to: 'off'
    for:
      hours: 0
      minutes: 2
      seconds: 0
  conditions:
  - condition: state
    entity_id: input_boolean.room_exclude_bathrooms
    state: 'off'
  actions:
  - choose:
    - conditions:
      - condition: and
        conditions:
        - condition: trigger
          id:
          - 'on'
        - condition: numeric_state
          entity_id: sensor.motion_nightlight_illuminance
          below: 15
      sequence:
      - action: light.turn_on
        metadata: {}
        data:
          rgb_color:
          - 255
          - 0
          - 0
          brightness_pct: 55
          transition: 1
        target:
          entity_id: light.motion_nightlight
      alias: On, if room brightness is low enough
    - conditions:
      - condition: trigger
        id:
        - 'off'
      sequence:
      - action: light.turn_off
        metadata: {}
        data:
          transition: 2
        target:
          entity_id: light.motion_nightlight
  mode: restart
