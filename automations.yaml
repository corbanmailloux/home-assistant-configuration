- id: '1703638107345'
  alias: Office Closet Light - Door Trigger
  description: ''
  use_blueprint:
    path: mkosmo/closet-light-from-door-sensor.yaml
    input:
      door_sensor: binary_sensor.office_closet_door_sensor_contact
      light_switch:
        entity_id: light.office_closet_light
      light_timeout: 1800
- id: '1705870296732'
  alias: Hall Aux Switch - Pause Living Room TV
  description: ''
  triggers:
  - trigger: device
    domain: mqtt
    device_id: f6a3f0606ae31f561f4c700f5917deed
    type: action
    subtype: aux_config_single
    discovery_id: 0xb43a31fffe34e475 action_aux_config_single
  conditions: []
  actions:
  - action: media_player.media_play_pause
    metadata: {}
    data: {}
    target:
      device_id: 0e47eccd7765e50037be8ffc24099a13
  mode: single
- id: '1710728057701'
  alias: Linen Closet Light - Door Trigger
  description: ''
  use_blueprint:
    path: mkosmo/closet-light-from-door-sensor.yaml
    input:
      door_sensor: binary_sensor.linen_closet_door_sensor_contact
      light_switch:
        entity_id:
        - light.linen_closet_light
      light_timeout: 1800
- id: '1710728130096'
  alias: Coat Closet Light - Door Trigger
  description: ''
  use_blueprint:
    path: mkosmo/closet-light-from-door-sensor.yaml
    input:
      door_sensor: binary_sensor.coat_closet_door_sensor_contact
      light_switch:
        entity_id: light.coat_closet_light
      light_timeout: 1800
- id: '1710814441742'
  alias: Hold Kitchen Light Switches to Control Area Lights
  description: ''
  triggers:
  - domain: mqtt
    device_id: 9f61f3f1b573c3799a54ee705f98034f
    type: action
    subtype: up_held
    id: 'on'
    trigger: device
  - domain: mqtt
    device_id: 9f61f3f1b573c3799a54ee705f98034f
    type: action
    subtype: down_held
    id: 'off'
    trigger: device
  - domain: mqtt
    device_id: f6a3f0606ae31f561f4c700f5917deed
    type: action
    subtype: up_held
    id: 'on'
    trigger: device
  - domain: mqtt
    device_id: f6a3f0606ae31f561f4c700f5917deed
    type: action
    subtype: down_held
    id: 'off'
    trigger: device
  - domain: mqtt
    device_id: 9f61f3f1b573c3799a54ee705f98034f
    type: action
    subtype: up_double
    trigger: device
    id: 'on'
  - domain: mqtt
    device_id: 9f61f3f1b573c3799a54ee705f98034f
    type: action
    subtype: down_double
    trigger: device
    id: 'off'
  - domain: mqtt
    device_id: f6a3f0606ae31f561f4c700f5917deed
    type: action
    subtype: up_double
    trigger: device
    id: 'on'
  - domain: mqtt
    device_id: f6a3f0606ae31f561f4c700f5917deed
    type: action
    subtype: down_double
    trigger: device
    id: 'off'
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - 'on'
      sequence:
      - metadata: {}
        data: {}
        target:
          area_id: 4872200594374640b069eaeee79e9ec6
        action: light.turn_on
    - conditions:
      - condition: trigger
        id:
        - 'off'
      sequence:
      - metadata: {}
        data: {}
        target:
          area_id: 4872200594374640b069eaeee79e9ec6
        action: light.turn_off
  mode: single
- id: '1710989410744'
  alias: Display Garage Door Status on Kitchen Bar Light LED Strip
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - cover.ratgdo_left_garage_door_door
    - cover.ratgdo_right_garage_door_door
    - binary_sensor.garage_side_person_door_contact
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: or
        conditions:
        - condition: state
          entity_id: cover.ratgdo_right_garage_door_door
          state: open
        - condition: state
          entity_id: cover.ratgdo_left_garage_door_door
          state: open
        - condition: state
          entity_id: binary_sensor.garage_side_person_door_contact
          state: 'on'
      sequence:
      - action: script.inovelli_led_control
        metadata: {}
        data:
          led: All
          color: Purple
          level: 62
          duration: Indefinitely
          target:
            device_id: 9f61f3f1b573c3799a54ee705f98034f
          effect: Solid
        alias: Set LED strip to purple - Kitchen Bar Light
      - alias: Set LED strip to purple - Utility Closet Light
        action: script.inovelli_led_control
        metadata: {}
        data:
          led: All
          color: Purple
          level: 62
          duration: Indefinitely
          effect: Solid
          target:
            device_id: b61d7bab7432d5e91ddb6fb6e28bf5fd
      alias: If any door is open
    default:
    - action: script.inovelli_led_control
      metadata: {}
      data:
        led: All
        target:
          device_id: 9f61f3f1b573c3799a54ee705f98034f
        effect: Clear
      alias: Clear LED Strip - Kitchen Bar Light
    - alias: Clear LED Strip - Utility Closet Light
      action: script.inovelli_led_control
      metadata: {}
      data:
        led: All
        target:
          device_id:
          - b61d7bab7432d5e91ddb6fb6e28bf5fd
        effect: Clear
  mode: single
- id: '1711145973507'
  alias: Pantry Door Light
  description: ''
  use_blueprint:
    path: mkosmo/closet-light-from-door-sensor.yaml
    input:
      door_sensor: binary_sensor.pantry_door_sensor_contact
      light_switch:
        entity_id: light.pantry_lights
      light_timeout: 1200
- id: '1711159946532'
  alias: Hall Light Aux Switch - Hold to Control Multiple Lights
  description: ''
  triggers:
  - domain: mqtt
    device_id: f6a3f0606ae31f561f4c700f5917deed
    type: action
    subtype: aux_up_held
    id: 'on'
    trigger: device
  - domain: mqtt
    device_id: f6a3f0606ae31f561f4c700f5917deed
    type: action
    subtype: aux_down_double
    trigger: device
    id: 'off'
  - domain: mqtt
    device_id: f6a3f0606ae31f561f4c700f5917deed
    type: action
    subtype: aux_down_held
    trigger: device
    id: 'off'
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - 'on'
      sequence:
      - metadata: {}
        data:
          transition: 0
        target:
          entity_id:
          - light.first_floor_hall_light
          - light.kitchen_main_lights
          - light.kitchen_bar_light
        action: light.turn_on
    - conditions:
      - condition: trigger
        id:
        - 'off'
      sequence:
      - metadata: {}
        data:
          transition: 0
        target:
          entity_id:
          - light.first_floor_hall_light
          - light.kitchen_main_lights
          - light.kitchen_bar_light
        action: light.turn_off
  mode: single
- id: '1712374070637'
  alias: Mudroom Lamp Follows Kitchen Bar Light
  description: ''
  triggers:
  - type: turned_on
    device_id: 9f61f3f1b573c3799a54ee705f98034f
    entity_id: bf668f7758c2b3fe2ca6adb4bf41ea23
    domain: light
    id: 'on'
    trigger: device
  - type: turned_off
    device_id: 9f61f3f1b573c3799a54ee705f98034f
    entity_id: bf668f7758c2b3fe2ca6adb4bf41ea23
    domain: light
    id: 'off'
    trigger: device
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - 'on'
      sequence:
      - metadata: {}
        data:
          transition: 0
          brightness_pct: 100
        target:
          device_id: def287c341c870f1a188cf2c5e84a3a3
        action: light.turn_on
      - metadata: {}
        data:
          transition: 0
          brightness_pct: 100
          color_temp_kelvin: 3200
        action: light.turn_on
        target:
          device_id: 5fde3d24df137723731bafe28dd07084
    - conditions:
      - condition: trigger
        id:
        - 'off'
      sequence:
      - metadata: {}
        data:
          transition: 0
        target:
          device_id:
          - def287c341c870f1a188cf2c5e84a3a3
          - 5fde3d24df137723731bafe28dd07084
        action: light.turn_off
  mode: single
- id: '1712671842634'
  alias: Guest Room Remote
  description: ''
  triggers:
  - device_id: f55558e66b8f403aed6dc6acc7450363
    domain: lutron_caseta
    type: press
    subtype: 'on'
    id: 'on'
    trigger: device
  - device_id: f55558e66b8f403aed6dc6acc7450363
    domain: lutron_caseta
    type: press
    subtype: 'off'
    id: 'off'
    trigger: device
  - device_id: f55558e66b8f403aed6dc6acc7450363
    domain: lutron_caseta
    type: press
    subtype: stop
    id: center
    trigger: device
  - device_id: f55558e66b8f403aed6dc6acc7450363
    domain: lutron_caseta
    type: press
    subtype: raise
    id: up
    trigger: device
  - device_id: f55558e66b8f403aed6dc6acc7450363
    domain: lutron_caseta
    type: press
    subtype: lower
    id: down
    trigger: device
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - 'on'
      sequence:
      - if:
        - condition: state
          entity_id: light.guest_bedroom_ceiling_fan_light
          state: 'on'
        then:
        - metadata: {}
          data:
            brightness_pct: 100
          target:
            entity_id: light.guest_bedroom_ceiling_fan_light
          action: light.turn_on
        else:
        - metadata: {}
          data: {}
          target:
            entity_id: light.guest_bedroom_ceiling_fan_light
          action: light.turn_on
        alias: Main light on, or to full brightness
    - conditions:
      - condition: trigger
        id:
        - 'off'
      sequence:
      - action: light.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: light.guest_bedroom_ceiling_fan_light
    - conditions:
      - condition: trigger
        id:
        - center
      sequence:
      - action: light.toggle
        metadata: {}
        data: {}
        target:
          entity_id: light.fairy_lights
    - conditions:
      - condition: trigger
        id:
        - up
      sequence:
      - alias: Brightness up
        metadata: {}
        data:
          brightness_step_pct: 25
        target:
          entity_id: light.guest_bedroom_ceiling_fan_light
        action: light.turn_on
    - conditions:
      - condition: trigger
        id:
        - down
      sequence:
      - metadata: {}
        data:
          brightness_step_pct: -25
        target:
          entity_id: light.guest_bedroom_ceiling_fan_light
        alias: Brightness down
        action: light.turn_on
  mode: single
- id: '1714258867767'
  alias: Kitchen Bar Light Switch - Double Tap Config for Garage Doors
  description: ''
  triggers:
  - trigger: device
    domain: mqtt
    device_id: 9f61f3f1b573c3799a54ee705f98034f
    type: action
    subtype: config_double
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: or
        conditions:
        - condition: device
          device_id: 2bbbe29de187f6e1b1522f5f2513b258
          domain: cover
          entity_id: 5401d8e4327d5e9b6d71d56d09b8ec35
          type: is_open
        - condition: device
          device_id: a918ed1d740d5527c120a872d5b36fdd
          domain: cover
          entity_id: fa3c1b2c28746f6e9edce10a8a74e955
          type: is_open
      sequence:
      - action: cover.close_cover
        metadata: {}
        data: {}
        target:
          entity_id:
          - cover.ratgdo_right_garage_door_door
          - cover.ratgdo_left_garage_door_door
      alias: 'If either garage door is open, close it. '
    default:
    - action: cover.open_cover
      metadata: {}
      data: {}
      target:
        entity_id: cover.ratgdo_left_garage_door_door
  mode: single
- id: '1715117158694'
  alias: Upstairs Hall Light Switch - Triple tap config to move Eve to dump spot
  description: ''
  triggers:
  - trigger: device
    domain: mqtt
    device_id: 6239543fc9a684fbba5d4af77ccdf052
    type: action
    subtype: config_triple
  conditions: []
  actions:
  - action: script.vacuum_dump_process
    metadata: {}
    data: {}
  mode: single
- id: '1724423649065'
  alias: Stairs Wall Switch - Red During Meetings
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.corban_on_a_call
    from: 'off'
    to: 'on'
    id: 'on'
  - trigger: state
    entity_id:
    - binary_sensor.corban_on_a_call
    from: 'on'
    to: 'off'
    id: 'off'
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - 'on'
      sequence:
      - action: script.inovelli_led_control
        metadata: {}
        data:
          led: All
          color: Red
          level: 100
          duration: Indefinitely
          target:
            device_id: 6239543fc9a684fbba5d4af77ccdf052
          effect: Aurora
    - conditions:
      - condition: trigger
        id:
        - 'off'
      sequence:
      - action: script.inovelli_led_control
        metadata: {}
        data:
          led: All
          color: Red
          level: 100
          duration: Indefinitely
          target:
            device_id: 6239543fc9a684fbba5d4af77ccdf052
          effect: Clear
  mode: single
- id: '1724980786427'
  alias: Notify if windows are open with rain forecast overnight
  description: ''
  triggers:
  - trigger: time
    at: '22:00:00'
  conditions:
  - condition: state
    entity_id: input_select.home_mode
    state: Home
  - condition: numeric_state
    entity_id: sensor.open_window_count
    above: 0
  actions:
  - action: weather.get_forecasts
    metadata: {}
    data:
      type: hourly
    target:
      entity_id: weather.openweathermap
    response_variable: forecasts
    alias: Get Hourly Forecast
  - variables:
      hours_to_check: 8
      precip_percent_min: 70
      entity_id: weather.openweathermap
      max_precipitation_chance: '{{ forecasts[entity_id].forecast[0:hours_to_check]
        | map(attribute=''precipitation_probability'') | max }}'
  - alias: Check if there's >70% chance of rain in the next 8 hours
    condition: template
    value_template: '{{ max_precipitation_chance > precip_percent_min }}'
  - action: notify.corban
    metadata: {}
    data:
      title: Rain Tonight. Close Windows?
      message: 'There is a {{ max_precipitation_chance }}% chance of rain tonight
        and these windows are open: {{ states(''sensor.open_windows'') }}'
  mode: single
- id: '1725645532252'
  alias: Notify Corban when Ben leaves with guest mode on
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - device_tracker.bens_iphone_se_unifi
    to: not_home
    from: home
    for:
      hours: 0
      minutes: 3
      seconds: 0
  conditions:
  - condition: state
    entity_id: input_boolean.guest_mode
    state: 'on'
  - condition: state
    entity_id: binary_sensor.corban_person_home
    state: 'off'
  actions:
  - action: notify.corban
    metadata: {}
    data:
      message: Ben left
      title: Ben Left
  mode: single
- id: '1725649471485'
  alias: Toggle Living Room Cabinet Lights with Wall Switch Button
  description: ''
  triggers:
  - trigger: device
    domain: mqtt
    device_id: 21e10aa0c624e6abdcbbbbb97e0373c5
    type: action
    subtype: config_single
  - trigger: device
    domain: mqtt
    device_id: d9db549c961eecf0f3fc66794fe297ad
    type: action
    subtype: config_single
  conditions: []
  actions:
  - action: light.toggle
    metadata: {}
    data:
      brightness_pct: 100
    target:
      entity_id: light.living_room_cabinet_lights
  mode: single
- id: '1725812307580'
  alias: Reload the Wall Display After Home Assistant Restarts
  description: ''
  triggers:
  - trigger: homeassistant
    event: start
  conditions: []
  actions:
  - action: script.tablet_wall_display_reload
    metadata: {}
    data: {}
  mode: single
- id: '1735588370721'
  alias: Office Closet Light - Door Trigger
  description: ''
  use_blueprint:
    path: mkosmo/closet-light-from-door-sensor.yaml
    input:
      door_sensor: binary_sensor.office_closet_door_sensor_contact
      light_switch:
        entity_id: light.office_closet
      light_timeout: 900
- id: '1735601423932'
  alias: Movie Mode - Lighting and Pause
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - media_player.living_room_apple_tv
    to: playing
    for:
      hours: 0
      minutes: 0
      seconds: 2
    id: playing
  - trigger: state
    entity_id:
    - media_player.living_room_apple_tv
    to:
    - paused
    - standby
    - 'off'
    id: paused
    for:
      seconds: 5
  - trigger: state
    entity_id:
    - input_boolean.movie_mode_active
    to: 'on'
    from: 'off'
    id: movie_mode_start
  - trigger: state
    entity_id:
    - input_boolean.movie_mode_active
    to: 'off'
    from: 'on'
    id: movie_mode_end
  - trigger: state
    entity_id:
    - binary_sensor.living_room_couch_presence
    from: 'on'
    to: 'off'
    id: couch_empty
  conditions:
  - condition: state
    entity_id: input_boolean.room_exclude_livingroom
    state: 'off'
    alias: Living Room automations are enabled
  - condition: state
    entity_id: input_select.home_mode
    state: Home
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - movie_mode_start
      sequence:
      - action: scene.turn_on
        metadata: {}
        target:
          entity_id: scene.movie_mode
        data:
          transition: 2
    - conditions:
      - condition: trigger
        id:
        - movie_mode_end
      sequence:
      - alias: If Cabinet Lights are on, set to bright. Otherwise, skip.
        if:
        - condition: state
          entity_id: light.living_room_cabinet_lights
          state: 'on'
        then:
        - action: scene.turn_on
          metadata: {}
          target:
            entity_id: scene.movie_mode_end
          data:
            transition: 2
  - condition: state
    entity_id: input_boolean.movie_mode_active
    state: 'on'
  - choose:
    - conditions:
      - condition: trigger
        id:
        - playing
      sequence:
      - action: scene.turn_on
        metadata: {}
        target:
          entity_id: scene.movie_mode
        data:
          transition: 1
    - conditions:
      - condition: trigger
        id:
        - paused
      sequence:
      - action: scene.turn_on
        metadata: {}
        data:
          transition: 1
        target:
          entity_id: scene.movie_mode_pause
    - conditions:
      - condition: trigger
        id:
        - couch_empty
      sequence:
      - action: media_player.media_pause
        metadata: {}
        data: {}
        target:
          entity_id: media_player.living_room_apple_tv
  mode: single
- id: '1735606719113'
  alias: Dining Room Switch - Dining Scene
  description: ''
  triggers:
  - domain: mqtt
    device_id: 8eb976a9c0f474a3f6de93a5f04bcb72
    type: action
    subtype: config_double
    trigger: device
  conditions: []
  actions:
  - action: scene.turn_on
    metadata: {}
    target:
      entity_id: scene.dining
    data:
      transition: 3
  mode: single
- id: '1735871090165'
  alias: Movie Mode - Set Wall Switch LED Bar
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - input_boolean.movie_mode_active
    from: 'off'
    to: 'on'
    id: 'on'
  - trigger: state
    entity_id:
    - input_boolean.movie_mode_active
    from: 'on'
    to: 'off'
    id: 'off'
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - 'on'
      sequence:
      - action: script.inovelli_led_control
        metadata: {}
        data:
          led: All
          color: Orange
          level: 7
          effect: Solid
          duration: Indefinitely
          target:
            device_id: d9db549c961eecf0f3fc66794fe297ad
    - conditions:
      - condition: trigger
        id:
        - 'off'
      sequence:
      - action: script.inovelli_led_control
        metadata: {}
        data:
          led: All
          color: Orange
          level: 5
          duration: Indefinitely
          target:
            device_id: d9db549c961eecf0f3fc66794fe297ad
          effect: Clear
  mode: single
- id: '1735871229135'
  alias: Movie Mode - Toggle with Wall Switch buttons
  description: ''
  triggers:
  - domain: mqtt
    device_id: d9db549c961eecf0f3fc66794fe297ad
    type: action
    subtype: config_double
    trigger: device
  - domain: mqtt
    device_id: 21e10aa0c624e6abdcbbbbb97e0373c5
    type: action
    subtype: config_double
    trigger: device
  conditions: []
  actions:
  - action: input_boolean.toggle
    metadata: {}
    data: {}
    target:
      entity_id: input_boolean.movie_mode_active
  mode: single
- id: '1741665583779'
  alias: Master Bathroom - Motion and Lux Nightlight
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.motion_nightlight_occupancy
    to: 'on'
    id: 'on'
  - trigger: state
    entity_id:
    - binary_sensor.motion_nightlight_occupancy
    id: 'off'
    to: 'off'
    for:
      hours: 0
      minutes: 2
      seconds: 0
  conditions:
  - condition: state
    entity_id: input_boolean.room_exclude_bathrooms
    state: 'off'
  actions:
  - choose:
    - conditions:
      - condition: and
        conditions:
        - condition: trigger
          id:
          - 'on'
        - condition: numeric_state
          entity_id: sensor.motion_nightlight_illuminance
          below: 15
      sequence:
      - action: light.turn_on
        metadata: {}
        data:
          rgb_color:
          - 255
          - 0
          - 0
          brightness_pct: 55
          transition: 1
        target:
          entity_id: light.motion_nightlight
      alias: On, if room brightness is low enough
    - conditions:
      - condition: trigger
        id:
        - 'off'
      sequence:
      - action: light.turn_off
        metadata: {}
        data:
          transition: 2
        target:
          entity_id: light.motion_nightlight
  mode: restart
- id: '1743484522580'
  alias: Kitchen Bar Light - Config button to toggle lamp
  description: ''
  triggers:
  - domain: mqtt
    device_id: 9f61f3f1b573c3799a54ee705f98034f
    type: action
    subtype: config_single
    trigger: device
  conditions: []
  actions:
  - action: light.toggle
    metadata: {}
    data: {}
    target:
      entity_id: light.mudroom_triple_lamp
  mode: single
- id: '1743972311093'
  alias: Changing Table Remote
  description: ''
  triggers:
  - domain: mqtt
    device_id: 52b2f81b59b1104f1e7ee8114a23c2a0
    type: action
    subtype: toggle
    trigger: device
    id: center
  - domain: mqtt
    device_id: 52b2f81b59b1104f1e7ee8114a23c2a0
    type: action
    subtype: brightness_up_click
    trigger: device
    id: up
  - domain: mqtt
    device_id: 52b2f81b59b1104f1e7ee8114a23c2a0
    type: action
    subtype: brightness_down_click
    trigger: device
    id: down
  - domain: mqtt
    device_id: 52b2f81b59b1104f1e7ee8114a23c2a0
    type: action
    subtype: arrow_left_click
    trigger: device
    id: left
  - domain: mqtt
    device_id: 52b2f81b59b1104f1e7ee8114a23c2a0
    type: action
    subtype: arrow_right_click
    trigger: device
    id: right
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - center
      sequence:
      - action: light.toggle
        metadata: {}
        data:
          brightness_pct: 1
          transition: 0
        target:
          entity_id:
          - light.lucys_dresser_lamp
      alias: Center - Toggle Light
    - conditions:
      - condition: trigger
        id:
        - left
        - up
        - right
      sequence:
      - action: scene.create
        metadata: {}
        data:
          scene_id: lucy_nightlight_remote_pre
          snapshot_entities:
          - light.lucys_nightlight
      - choose:
        - conditions:
          - condition: trigger
            id:
            - left
          sequence:
          - action: rest_command.pee_and_or_poop
            metadata: {}
            data:
              wet_bool: 'True'
              solid_bool: 'False'
            response_variable: response
          - variables:
              action_color:
              - 255
              - 255
              - 0
          alias: Left - Pee
        - conditions:
          - condition: trigger
            id:
            - up
          sequence:
          - action: rest_command.pee_and_or_poop
            metadata: {}
            data:
              wet_bool: 'True'
              solid_bool: 'True'
            response_variable: response
          - variables:
              action_color:
              - 128
              - 0
              - 128
          alias: Up - Pee and Poop
        - conditions:
          - condition: trigger
            id:
            - right
          sequence:
          - action: rest_command.pee_and_or_poop
            metadata: {}
            data:
              wet_bool: 'False'
              solid_bool: 'True'
            response_variable: response
          - variables:
              action_color:
              - 255
              - 140
              - 0
          alias: Right - Poop
      - alias: Check API response code and set light
        if:
        - alias: API Success Response
          condition: template
          value_template: '{{ response["status"] == 201 }}'
        then:
        - alias: Flash nightlight green
          repeat:
            count: 1
            sequence:
            - action: light.turn_on
              metadata: {}
              data:
                transition: 0
                rgb_color:
                - 0
                - 255
                - 0
                brightness_pct: 74
              target:
                entity_id: light.lucys_nightlight
            - delay:
                hours: 0
                minutes: 0
                seconds: 0
                milliseconds: 500
            - action: light.turn_off
              metadata: {}
              data:
                transition: 0
              target:
                entity_id: light.lucys_nightlight
            - delay:
                hours: 0
                minutes: 0
                seconds: 0
                milliseconds: 500
            - action: light.turn_on
              metadata: {}
              data:
                transition: 0
                rgb_color: '{{ action_color }}'
                brightness_pct: 74
              target:
                entity_id: light.lucys_nightlight
            - delay:
                hours: 0
                minutes: 0
                seconds: 0
                milliseconds: 500
            - action: light.turn_off
              metadata: {}
              data:
                transition: 0
              target:
                entity_id: light.lucys_nightlight
            - delay:
                hours: 0
                minutes: 0
                seconds: 0
                milliseconds: 500
        else:
        - alias: Flash nightlight red
          repeat:
            count: 2
            sequence:
            - action: light.turn_on
              metadata: {}
              data:
                transition: 0
                rgb_color:
                - 255
                - 0
                - 0
                brightness_pct: 74
              target:
                entity_id: light.lucys_nightlight
            - delay:
                hours: 0
                minutes: 0
                seconds: 0
                milliseconds: 500
            - action: light.turn_off
              metadata: {}
              data:
                transition: 0
              target:
                entity_id: light.lucys_nightlight
            - delay:
                hours: 0
                minutes: 0
                seconds: 0
                milliseconds: 500
        - action: notify.corban
          metadata: {}
          data:
            title: Baby Buddy - Error logging diaper
            message: '{{ response }}'
      - delay:
          hours: 0
          minutes: 0
          seconds: 0
          milliseconds: 500
      - action: scene.turn_on
        metadata: {}
        data:
          transition: 1
        target:
          entity_id: scene.lucy_nightlight_remote_pre
      alias: Left, Up, Right - Diaper Logging
  mode: single
- id: '1744169676303'
  alias: Lucy's Nightlight - Motion and Lux
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.lucys_nightlight_occupancy
    to: 'on'
    id: 'on'
  - trigger: state
    entity_id:
    - binary_sensor.lucys_nightlight_occupancy
    id: 'off'
    to: 'off'
    for:
      hours: 0
      minutes: 3
      seconds: 0
  conditions:
  - condition: state
    entity_id: input_boolean.room_exclude_lucys_room
    state: 'off'
  actions:
  - choose:
    - conditions:
      - condition: and
        conditions:
        - condition: trigger
          id:
          - 'on'
        - condition: numeric_state
          entity_id: sensor.lucys_nightlight_illuminance
          below: 15
      sequence:
      - action: light.turn_on
        metadata: {}
        data:
          rgb_color:
          - 255
          - 175
          - 91
          brightness_pct: 50
          transition: 1
        target:
          entity_id:
          - light.lucys_nightlight
      alias: On, if room brightness is low enough
    - conditions:
      - condition: trigger
        id:
        - 'off'
      sequence:
      - condition: state
        entity_id: light.lucys_nightlight
        state: 'on'
      - action: light.turn_off
        metadata: {}
        data:
          transition: 2
        target:
          entity_id:
          - light.lucys_nightlight
  mode: restart
- id: '1744675790269'
  alias: Bedside Buttons - Toggle Headboard Lights
  description: ''
  triggers:
  - domain: mqtt
    device_id: ac01e2cb060249f980958e940eb74383
    type: action
    subtype: single
    trigger: device
    alias: Corban - Single click
  - domain: mqtt
    device_id: 902fe0fc069711eb8fc8e19795714a1d
    type: action
    subtype: arrow_right_click
    trigger: device
    alias: Maggie - Right Arrow
  - alias: Maggie - Center Button
    domain: mqtt
    device_id: 902fe0fc069711eb8fc8e19795714a1d
    type: action
    subtype: toggle
    trigger: device
  - domain: mqtt
    device_id: 6239543fc9a684fbba5d4af77ccdf052
    type: action
    subtype: config_single
    trigger: device
    alias: Upstairs Hall Light Switch - Config Single
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: state
        entity_id: input_select.home_mode
        state: Sleep
        enabled: false
      - condition: time
        after: '21:00:00'
        before: 09:00:00
      sequence:
      - action: light.toggle
        metadata: {}
        data:
          transition: 2
          brightness_pct: 2
        target:
          entity_id: light.master_bedroom_headboard
    default:
    - action: light.toggle
      metadata: {}
      data:
        transition: 2
        brightness_pct: 75
      target:
        entity_id: light.master_bedroom_headboard
  mode: single
- id: '1745036234044'
  alias: Upstairs Light Switch - Config Single Press - Toggle Headboard
  description: ''
  triggers:
  - domain: mqtt
    device_id: 6239543fc9a684fbba5d4af77ccdf052
    type: action
    subtype: config_single
    trigger: device
  conditions: []
  actions:
  - data:
      brightness_pct: 10
      rgb_color:
      - 255
      - 78
      - 30
    action: light.toggle
    target:
      entity_id: light.master_bedroom_headboard
  mode: single
- id: '1745258240039'
  alias: Baby Timer - Show on Living Room Switch
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - switch.lucy_mailloux_timer
    to: 'off'
    from: 'on'
    id: 'off'
  - trigger: state
    entity_id:
    - switch.lucy_mailloux_timer
    to: 'on'
    id: 'on'
    from: 'off'
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - 'on'
      sequence:
      - action: script.inovelli_led_control
        metadata: {}
        data:
          color: Pink
          level: 100
          effect: Aurora
          duration: Indefinitely
          target:
            device_id:
            - d9db549c961eecf0f3fc66794fe297ad
          led: All
    - conditions:
      - condition: trigger
        id:
        - 'off'
      sequence:
      - action: script.inovelli_led_control
        metadata: {}
        data:
          color: Pink
          level: 100
          effect: Clear
          duration: Indefinitely
          target:
            device_id:
            - d9db549c961eecf0f3fc66794fe297ad
          led: All
  mode: single
- id: '1745344633140'
  alias: Living Room Switch - Double Down to Turn Off All Lights
  description: ''
  triggers:
  - domain: mqtt
    device_id: 21e10aa0c624e6abdcbbbbb97e0373c5
    type: action
    subtype: down_double
    trigger: device
  - domain: mqtt
    device_id: d9db549c961eecf0f3fc66794fe297ad
    type: action
    subtype: down_double
    trigger: device
  conditions: []
  actions:
  - action: light.turn_off
    metadata: {}
    data:
      transition: 2
    target:
      area_id: 6a82246dbc29484cb9558c88e6e7be5d
  mode: single
- id: '1745702388569'
  alias: Living Room Switch 2 - Toggle Corner Lamp
  description: ''
  triggers:
  - domain: mqtt
    device_id: 53afe29f4d972deb626552ed9a4f89f6
    type: action
    subtype: config_single
    trigger: device
  conditions: []
  actions:
  - action: light.toggle
    metadata: {}
    data: {}
    target:
      entity_id: light.corner_lamp
  mode: single
- id: '1745702457597'
  alias: Living Room Switch 3 - Toggle Reading Lamp
  description: ''
  triggers:
  - domain: mqtt
    device_id: ff32bc927588740f5739a61d42afee60
    type: action
    subtype: config_single
    trigger: device
  conditions: []
  actions:
  - action: light.toggle
    metadata: {}
    data: {}
    target:
      entity_id: light.reading_lamp
  mode: single
- id: '1746243913739'
  alias: Notify if Garage Door is Left Open When Leaving
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - input_select.home_mode
    to: Away
    for:
      hours: 0
      minutes: 0
      seconds: 30
  - trigger: state
    entity_id:
    - input_select.home_mode
    to: Vacation
    for:
      hours: 0
      minutes: 0
      seconds: 30
  conditions:
  - condition: or
    conditions:
    - condition: state
      entity_id: cover.ratgdo_left_garage_door_door
      state: open
    - condition: state
      state: open
      entity_id: cover.ratgdo_right_garage_door_door
    alias: If either door is open
  actions:
  - action: notify.adult_phones
    metadata: {}
    data:
      title: Garage Door Open
      data:
        tag: garage_door_open_reminder
        actions:
        - action: CLOSE_GARAGE_DOORS
          title: Close Garage Doors
          activationMode: background
          authenticationRequired: false
          destructive: false
          behavior: default
      message: A garage door was left open. Close it?
    alias: Notify adult phones
  - wait_for_trigger:
    - trigger: event
      event_type: mobile_app_notification_action
      event_data:
        action: CLOSE_GARAGE_DOORS
    continue_on_timeout: false
    timeout:
      hours: 24
      minutes: 0
      seconds: 0
      milliseconds: 0
    alias: Wait for notification action (or timeout)
  - action: cover.close_cover
    metadata: {}
    data: {}
    target:
      entity_id:
      - cover.ratgdo_left_garage_door_door
      - cover.ratgdo_right_garage_door_door
    alias: Close the garage doors
  - action: notify.adult_phones
    metadata: {}
    data:
      message: clear_notification
      data:
        tag: garage_door_open_reminder
    alias: Clear the notification from remaining devices
  mode: restart
- id: '1747349188668'
  alias: Tummy Time Reminder
  description: ''
  triggers:
  - trigger: time
    at: '16:00:00'
  conditions:
  - alias: No tummy time entered today
    condition: template
    value_template: '{{ as_timestamp(state_attr(''sensor.lucy_mailloux_last_tummy_time'',
      ''start'')) | timestamp_custom(''%Y-%m-%d'') != now().date().isoformat() }}'
  - condition: not
    conditions:
    - condition: state
      entity_id: input_select.home_mode
      state: Vacation
    alias: Not on vacation
  actions:
  - action: notify.adult_phones
    metadata: {}
    data:
      message: No tummy time has been entered today.
      title: Tummy Time?
  mode: single
- id: '1747521825959'
  alias: Notify if Lucy’s timer is running for too long
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - switch.lucy_mailloux_timer
    to: 'on'
    for:
      hours: 2
      minutes: 0
      seconds: 0
    enabled: false
  - trigger: time
    at:
      entity_id: sensor.lucy_timer_start_time
      offset: '2:00:00'
  conditions:
  - condition: time
    after: 08:00:00
    before: '20:00:00'
  actions:
  - action: notify.adult_phones
    metadata: {}
    data:
      title: Napping Too Long?
      message: A BabyBuddy timer has been running for more than 2 hours.
      data:
        group: babybuddy
        tag: baby-nap-too-long
  - wait_for_trigger:
    - trigger: state
      entity_id:
      - switch.lucy_mailloux_timer
      to: 'off'
    continue_on_timeout: false
    timeout:
      hours: 3
      minutes: 0
      seconds: 0
      milliseconds: 0
  - action: notify.adult_phones
    metadata: {}
    data:
      data:
        tag: baby-nap-too-long
      message: clear_notification
    alias: Clear notification
  mode: single
- id: '1748960622382'
  alias: Wake window timer reminder
  description: ''
  triggers:
  - trigger: time
    at:
      entity_id: sensor.lucy_last_sleep_end_timestamp
      offset: '2:00:00'
  conditions:
  - condition: time
    after: 08:00:00
    before: '21:00:00'
  - condition: state
    entity_id: switch.lucy_mailloux_timer
    state: 'off'
  actions:
  - action: notify.adult_phones
    metadata: {}
    data:
      title: Wake Window Ending
      message: It's been more than 2 hours since a sleep entry. Is it nap time?
      data:
        group: babybuddy
        tag: baby-wake-window-ending
  - wait_for_trigger:
    - trigger: state
      entity_id:
      - switch.lucy_mailloux_timer
      to: 'on'
    continue_on_timeout: false
    timeout:
      hours: 3
      minutes: 0
      seconds: 0
      milliseconds: 0
  - alias: Clear notification
    action: notify.adult_phones
    metadata: {}
    data:
      data:
        tag: baby-wake-window-ending
      message: clear_notification
  mode: single
- id: '1748974264156'
  alias: Turn off sprinkler at end of timer
  description: ''
  triggers:
  - trigger: event
    event_type: timer.finished
    event_data:
      entity_id: timer.irrigation_off_timer
  conditions: []
  actions:
  - action: switch.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: switch.sprinkler_valve_1
  mode: single
- id: '1750027073324'
  alias: Turn on exterior lights at night when a vehicle is detected
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.driveway_vehicle_detected
    - binary_sensor.driveway_person_detected
    from: 'off'
    to: 'on'
  conditions:
  - condition: time
    after: '23:00:00'
    before: 05:00:00
  actions:
  - action: light.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: light.exterior_lights
  - delay:
      hours: 0
      minutes: 5
      seconds: 0
      milliseconds: 0
  - action: light.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: light.exterior_lights
  mode: restart
- id: '1750264262233'
  alias: Notify on low litter level
  description: ''
  triggers:
  - trigger: numeric_state
    entity_id:
    - sensor.litter_robot_4_litter_level
    below: 70
  conditions: []
  actions:
  - action: notify.corban
    metadata: {}
    data:
      title: Litter Low
      message: Check the box.
  mode: single
- id: '1750469258428'
  alias: Maggie’s Alarm
  description: ''
  triggers:
  - trigger: event
    event_type: maggie_ios_alarm
  conditions:
  - condition: or
    conditions:
    - condition: state
      entity_id: input_select.home_mode
      state: Home
    - condition: state
      entity_id: input_select.home_mode
      state: Sleep
    alias: Home or Sleep
  actions:
  - action: light.turn_on
    metadata: {}
    data:
      transition: 2
      brightness_pct: 100
    target:
      entity_id: light.fairy_lights
  mode: single
- id: '1750769716810'
  alias: Triple tap config on kitchen bar switch to open right garage door
  description: ''
  triggers:
  - domain: mqtt
    device_id: 9f61f3f1b573c3799a54ee705f98034f
    type: action
    subtype: config_triple
    trigger: device
  conditions: []
  actions:
  - action: cover.toggle
    metadata: {}
    data: {}
    target:
      entity_id: cover.ratgdo_right_garage_door_door
  mode: single
- id: '1750861927898'
  alias: Notify Corban on HVAC error
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - sensor.mitp_heat_pump_first_floor_error_code
    from: No Error Reported
    not_to:
    - unavailable
    id: First Floor HVAC
  - trigger: state
    entity_id:
    - sensor.mitp_heat_pump_second_floor_error_code
    from: No Error Reported
    not_to:
    - unavailable
    id: Second Floor HVAC
  conditions: []
  actions:
  - action: notify.corban
    metadata: {}
    data:
      title: HVAC Error
      message: 'Error in {{ trigger.id }}: {{ trigger.to_state.state }}'
  mode: single
- id: '1750862231781'
  alias: Notify when HVAC filter needs to be replaced
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.mitp_heat_pump_first_floor_filter_status
    id: First Floor HVAC
    to: 'on'
    from: 'off'
  - trigger: state
    entity_id:
    - binary_sensor.mitp_heat_pump_second_floor_filter_status
    id: Second Floor HVAC
    to: 'on'
    from: 'off'
  conditions: []
  actions:
  - action: notify.adult_phones
    metadata: {}
    data:
      title: HVAC Filter Needs to be Replaced
      message: The filter in the {{ trigger.id }} needs to be replaced.
  mode: single
- id: '1752358411714'
  alias: Living Room Switch 3 - Triple tap for curtain control
  description: ''
  triggers:
  - domain: mqtt
    device_id: ff32bc927588740f5739a61d42afee60
    type: action
    subtype: up_triple
    trigger: device
    id: Open
  - domain: mqtt
    device_id: ff32bc927588740f5739a61d42afee60
    type: action
    subtype: down_triple
    trigger: device
    id: Close
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - Open
      sequence:
      - action: cover.open_cover
        metadata: {}
        data: {}
        target:
          entity_id: cover.living_room_window_1_curtains
    - conditions:
      - condition: trigger
        id:
        - Close
      sequence:
      - action: cover.close_cover
        metadata: {}
        data: {}
        target:
          entity_id: cover.living_room_window_1_curtains
  mode: single
- id: '1754364930470'
  alias: Mower - Notify if Locked/Lifted
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - sensor.lucas_activity_mode
    to: MODE_LOCK
  conditions: []
  actions:
  - action: notify.corban
    metadata: {}
    data:
      message: Mower is locked or has been lifted. You need to manually reset it.
      title: Mower Locked
  mode: single
- id: '1754537218111'
  alias: Mower Schedule
  description: ''
  triggers:
  - trigger: time_pattern
    minutes: /15
  conditions:
  - condition: time
    weekday:
    - tue
    - wed
    - thu
    - fri
    after: '11:30:00'
    before: '19:00:00'
  - condition: state
    entity_id: input_boolean.mower_schedule_enabled
    state: 'on'
  - condition: state
    entity_id: input_boolean.mower_do_not_mow
    state: 'off'
  - condition: sun
    before: sunset
    before_offset: '-1:00:00'
    after: sunrise
    alias: Between sunrise and 1 hour before sunset
  actions:
  - variables:
      area_options:
      - back_yard_main
      - garage_side
      - front_yard
      - mailbox
      chosen_area: "{% set today = now().date() %} {% for cid in area_options %}\n
        \ {% set ent_id_last_mow = 'input_datetime.mower_last_mow_' ~ cid %}\n  {%
        set ent_id_schedule = 'input_number.mower_schedule_days_delay_' ~ cid %}\n
        \ {% set last_mow_dt = states(ent_id_last_mow) | as_datetime | as_local %}\n
        \ {% set delay = states(ent_id_schedule) | int %}\n  {% if (delay > 0) and
        (last_mow_dt.date() <= (today - timedelta(days=delay))) and \n    ( cid !=
        \"back_yard_main\" or \n    ( is_state(\"switch.sprinkler_valve_1\", \"off\")\n
        \     and (as_timestamp(now()) - as_timestamp(states.switch.sprinkler_valve_1.last_changed
        | default(0))) > 7200 )\n   )\n   %}\n    {{ cid }}\n    {% break %}\n  {%
        endif %}\n{% endfor %} \n"
    alias: Select the first valid yard zone
  - condition: template
    value_template: '{{ chosen_area != '''' }}'
    alias: Test if a yard zone is configured
  - action: notify.corban
    metadata: {}
    data:
      message: Mowing {{ chosen_area }}.
      title: Mower Schedule Triggered
  - alias: Start Mower Script for Area
    action: script.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: '{{ ''script.mower_mow_'' ~ chosen_area }}'
  mode: single
- id: '1754538262555'
  alias: Mower Schedule - Do Not Mow Controls
  description: Monitors various entities to enable and disable mowing based on conditions.
  triggers:
  - trigger: state
    entity_id:
    - sensor.lucas_activity_mode
    from:
    to:
  - trigger: state
    entity_id:
    - sensor.lucas_battery
    from:
    to:
  - trigger: state
    entity_id:
    - sensor.owmh_home_forecast0rain
    - sensor.owmh_home_day0rain
    - sensor.owmh_home_current_rain
    from:
    to:
  - trigger: state
    entity_id:
    - input_select.home_mode
    from:
    to:
  - trigger: state
    entity_id:
    - input_boolean.mower_schedule_enabled
    from: 'off'
    to: 'on'
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: state
        entity_id: input_select.home_mode
        state: Vacation
      sequence:
      - action: input_boolean.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: input_boolean.mower_do_not_mow
      - action: input_text.set_value
        metadata: {}
        data:
          value: Vacation Mode
        target:
          entity_id: input_text.mower_reason_no_mow
      alias: Vacation
    - conditions:
      - condition: not
        conditions:
        - condition: state
          entity_id: sensor.lucas_activity_mode
          state: MODE_READY
      sequence:
      - action: input_boolean.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: input_boolean.mower_do_not_mow
      - action: input_text.set_value
        metadata: {}
        data:
          value: Mower Not Ready
        target:
          entity_id: input_text.mower_reason_no_mow
      alias: Mower Not Ready
    - conditions:
      - condition: numeric_state
        entity_id: sensor.lucas_battery
        below: 95
      sequence:
      - action: input_boolean.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: input_boolean.mower_do_not_mow
      - action: input_text.set_value
        metadata: {}
        data:
          value: Mower Battery Not Charged
        target:
          entity_id: input_text.mower_reason_no_mow
      alias: Mower Battery Not Charged
    - conditions:
      - condition: numeric_state
        entity_id: sensor.owmh_home_day0rain
        above: 0.75
      sequence:
      - action: input_boolean.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: input_boolean.mower_do_not_mow
      - action: input_text.set_value
        metadata: {}
        data:
          value: Heavy Rain Recently
        target:
          entity_id: input_text.mower_reason_no_mow
      alias: Heavy Rain - Historical
    - conditions:
      - condition: numeric_state
        entity_id: sensor.owmh_home_forecast0rain
        above: 0.5
      sequence:
      - action: input_boolean.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: input_boolean.mower_do_not_mow
      - action: input_text.set_value
        metadata: {}
        data:
          value: Heavy Rain Predicted
        target:
          entity_id: input_text.mower_reason_no_mow
      alias: Heavy Rain - Predicted
    - conditions:
      - condition: numeric_state
        entity_id: sensor.owmh_home_current_rain
        above: 0.2
      sequence:
      - action: input_boolean.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: input_boolean.mower_do_not_mow
      - action: input_text.set_value
        metadata: {}
        data:
          value: Currently Raining
        target:
          entity_id: input_text.mower_reason_no_mow
      alias: Rain - Current
    default:
    - action: input_boolean.turn_off
      metadata: {}
      data: {}
      target:
        entity_id: input_boolean.mower_do_not_mow
      alias: Turn off "Do Not Mow"
    - alias: Clear the No Mow Reason
      action: input_text.set_value
      metadata: {}
      data:
        value: None
      target:
        entity_id: input_text.mower_reason_no_mow
  mode: single
- id: '1756128484018'
  alias: Trigger Corban’s location update when leaving
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - person.corban
    to: not_home
    from: home
  conditions: []
  actions:
  - action: script.request_corban_location_update
    metadata: {}
    data: {}
  mode: single
- id: '1756138764072'
  alias: Hold-to-Cycle Brightness - Office Ceiling Lights
  description: ''
  use_blueprint:
    path: corbanmailloux/inovelli_hold_to_dim.yaml
    input:
      switch_device: 0d88963feb93fc454e4d3c4115034675
      light_entity: light.office_ceiling
      step_size: 25
- id: '1756139380632'
  alias: Hold-to-Cycle Brightness - Cabinet Lights
  description: ''
  use_blueprint:
    path: corbanmailloux/inovelli_hold_to_dim.yaml
    input:
      switch_device: 21e10aa0c624e6abdcbbbbb97e0373c5
      light_entity: light.living_room_cabinet_lights
      step_size: 25
- id: '1756139422665'
  alias: Hold-to-Cycle Brightness - Living Room Corner Lamp
  description: ''
  use_blueprint:
    path: corbanmailloux/inovelli_hold_to_dim.yaml
    input:
      switch_device: 53afe29f4d972deb626552ed9a4f89f6
      light_entity: light.corner_lamp
- id: '1756139451249'
  alias: Hold-to-Cycle Brightness - Living Room Reading Lamp
  description: ''
  use_blueprint:
    path: corbanmailloux/inovelli_hold_to_dim.yaml
    input:
      switch_device: ff32bc927588740f5739a61d42afee60
      light_entity: light.reading_lamp
- id: '1756155639815'
  alias: Master Bedroom Proxy Button Actions
  description: ''
  use_blueprint:
    path: corbanmailloux/esphome_ble_proxy_buttons.yaml
    input:
      event_entity: event.bluetooth_proxy_master_bedroom_bluetooth_proxy_master_bedroom_button_event
      single_press:
      - choose:
        - conditions:
          - condition: time
            after: '21:00:00'
            before: 09:00:00
          sequence:
          - action: light.toggle
            metadata: {}
            data:
              transition: 2
              brightness_pct: 2
            target:
              entity_id: light.master_bedroom_headboard
            alias: Toggle Dim
        default:
        - action: light.toggle
          metadata: {}
          data:
            transition: 2
            brightness_pct: 75
          target:
            entity_id: light.master_bedroom_headboard
          alias: Toggle Bright
      double_press:
      - action: fan.toggle
        metadata: {}
        data: {}
        target:
          entity_id: fan.master_bedroom_ceiling_fan
      long_press:
      - alias: Activate sleep mode. If sleep mode is on, force everything off.
        choose:
        - conditions:
          - condition: state
            entity_id: input_select.home_mode
            state: Sleep
          sequence:
          - alias: Turn truly everything off
            data:
              ignore_room_exclusions: true
              include_fans: true
            action: script.everything_off
        default:
        - data:
            entity_id: input_select.home_mode
            option: Sleep
          action: input_select.select_option
- id: '1756865296776'
  alias: Sprinkler Schedule
  description: ''
  triggers:
  - trigger: time
    at: 06:59:00
    id: 'on'
  - trigger: time
    at: 07:15:00
    id: 'off'
  - trigger: time
    at: '11:59:00'
    id: 'on'
    enabled: false
  - trigger: time
    at: '12:05:00'
    id: 'off'
    enabled: false
  - trigger: time
    at: '17:14:00'
    id: 'on'
    enabled: false
  - trigger: time
    at: '17:21:00'
    id: 'off'
    enabled: false
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: and
        conditions:
        - condition: trigger
          id:
          - 'on'
        - condition: not
          conditions:
          - condition: state
            entity_id: sensor.lucas_work_area
            state: Main Back and Side
          alias: Lucas not in back yard
        - alias: Insignificant rain in the last 2 days or forcast today
          condition: template
          value_template: "{{ \nstates(\"sensor.owmh_home_current_rain\") | float(0)
            < 0.25\nand states(\"sensor.owmh_home_day0rain\") | float(0) < 0.25\nand
            states(\"sensor.owmh_home_day1rain\") | float(0) < 0.5\nand ((states(\"sensor.owmh_home_forecast0rain\")|float(0))
            * (states(\"sensor.owmh_home_forecast0pop\")|float(0))) < 0.5\n}}"
      sequence:
      - action: switch.turn_on
        metadata: {}
        data: {}
        target:
          entity_id: switch.sprinkler_valve_1
      alias: On - Mower not in back yard; insignificant rain
    - conditions:
      - condition: trigger
        id:
        - 'off'
      sequence:
      - action: switch.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: switch.sprinkler_valve_1
  mode: single
- id: '1756865878813'
  alias: Turn off sprinkler value after 40 minutes
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - switch.sprinkler_valve_1
    to: 'on'
    for:
      hours: 0
      minutes: 40
      seconds: 0
  conditions: []
  actions:
  - action: notify.corban
    metadata: {}
    data:
      title: Sprinkler Still On
      message: The sprinkler valve has been running for more than 40 minutes. Stopping
        automatically.
  - action: switch.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: switch.sprinkler_valve_1
  mode: single
- id: '1757898273542'
  alias: Water Leak Detected - Send Critical Notifications
  description: ''
  triggers:
  - trigger: state
    entity_id: binary_sensor.kitchen_sink_water_leak_sensor_water_sensor
    to: 'on'
    id: under the kitchen sink
  - trigger: state
    entity_id: binary_sensor.water_heater_water_leak_sensor_water_sensor
    to: 'on'
    id: near the water heater
  - trigger: state
    entity_id: binary_sensor.water_softener_water_leak_sensor_water_sensor
    to: 'on'
    id: near the water softener
  - trigger: state
    entity_id: binary_sensor.washing_machine_water_leak_sensor_water_sensor
    to: 'on'
    id: near the washing machine
  - trigger: state
    entity_id: binary_sensor.master_bathroom_sink_water_leak_sensor_water_sensor
    to: 'on'
    id: under the master bathroom sink
  - trigger: state
    entity_id: binary_sensor.guest_bathroom_sink_water_leak_sensor_water_sensor
    to: 'on'
    id: under the guest bathroom sink
  - trigger: state
    entity_id: binary_sensor.first_floor_bathroom_water_leak_sensor_water_sensor
    to: 'on'
    id: under the first floor bathroom sink
  - trigger: state
    entity_id:
    - binary_sensor.water_leak_sensor_first_floor_vacuum_water_sensor
    to: 'on'
    id: near the robot vacuum base station
  - trigger: state
    entity_id:
    - binary_sensor.water_leak_sensor_dehumidifier_water_sensor
    to: 'on'
    id: near the dehumidifier
  conditions: []
  actions:
  - alias: Notify Everyone with a Critical Notification
    action: notify.adult_ios_phones
    data:
      title: Water Leak Detected at Home
      message: Water detected {{ trigger.id }}.
      data:
        push:
          interruption-level: critical
  mode: single
- id: 03bcaae7-109c-4ccd-9392-d571c09518a8
  alias: Living Room Curtains - Match Window State
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - binary_sensor.living_room_window_1_contact
    from: 'on'
    to: 'off'
    id: closed
    for:
      hours: 0
      minutes: 0
      seconds: 2
  - trigger: state
    entity_id:
    - binary_sensor.living_room_window_1_contact
    from: 'off'
    to: 'on'
    id: open
    for:
      hours: 0
      minutes: 0
      seconds: 5
  conditions:
  - alias: Living room automations are not disabled
    condition: state
    entity_id: input_boolean.room_exclude_livingroom
    state: 'off'
  - condition: state
    entity_id: cover.living_room_curtain_left
    state: closed
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - open
      - condition: state
        entity_id: cover.living_room_curtain_right
        state: closed
      sequence:
      - alias: Open the Right Curtain
        action: v6_quietdrift.set_switchbot_curtain_position
        data:
          entity_id:
          - cover.living_room_curtain_right
          position: 100
          speed: 2
    - conditions:
      - condition: trigger
        id:
        - closed
      - condition: state
        entity_id: cover.living_room_curtain_right
        state: open
      sequence:
      - alias: Close the Right Curtain
        action: v6_quietdrift.set_switchbot_curtain_position
        data:
          entity_id:
          - cover.living_room_curtain_right
          position: 0
          speed: 2
  mode: restart
